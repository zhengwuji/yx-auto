# 快速参考指南

## 🔑 环境变量配置（必需）

在 Cloudflare Workers Dashboard → Settings → Environment Variables 中配置：

```
ADMIN_PASSWORD = [您的登录密码]
SESSION_SECRET = [随机生成的32位以上字符串]
```

### 快速生成密钥

```bash
# 生成 ADMIN_PASSWORD（强密码）
openssl rand -base64 24

# 生成 SESSION_SECRET（32位十六进制）
openssl rand -hex 32
```

---

## 📍 主要路径

| 路径 | 说明 | 认证 |
|------|------|------|
| `/` | 主页（订阅生成界面） | Cookie |
| `/login` | 登录页面 | 无 |
| `/logout` | 退出登录 | 无 |
| `/{UUID}/sub` | 订阅接口 | Token |
| `/api/stats` | 统计信息 | Cookie |
| `/api/visitors` | 访问者IP | Cookie |

---

## 🔗 订阅链接格式

```
https://your-worker.workers.dev/{UUID}/sub?domain=example.com&token=xxx
```

### 常用参数

| 参数 | 说明 | 默认值 |
|------|------|--------|
| `domain` | 节点域名 | **必需** |
| `token` | 订阅Token | **必需**（自动生成） |
| `epd=yes` | 启用优选域名 | yes |
| `epi=yes` | 启用优选IP | yes |
| `egi=yes` | 启用GitHub优选 | yes |
| `ev=yes` | 启用VLESS | yes |
| `et=yes` | 启用Trojan | no |
| `vm=yes` | 启用VMess | no |
| `ipv4=yes` | 启用IPv4 | yes |
| `ipv6=yes` | 启用IPv6 | yes |
| `dkby=yes` | 禁用非TLS | no |
| `path=/` | 自定义路径 | / |
| `target=base64` | 订阅格式 | base64 |

---

## 🚀 部署步骤（5分钟）

1. **创建 Worker**
   - Cloudflare Dashboard → Workers & Pages → Create Worker

2. **上传代码**
   - 复制 `服务器优选工具 - 简化版.js` 全部内容
   - 粘贴到 Worker 编辑器
   - Save and deploy

3. **配置环境变量**
   - Settings → Environment Variables
   - 添加 `ADMIN_PASSWORD` 和 `SESSION_SECRET`

4. **测试访问**
   - 访问 Worker URL
   - 使用密码登录

---

## 🔒 安全要点

1. ✅ **强密码**：`ADMIN_PASSWORD` 至少12位
2. ✅ **随机密钥**：`SESSION_SECRET` 使用随机生成
3. ✅ **不同密钥**：两个环境变量不要相同
4. ✅ **定期更换**：建议3-6个月更换一次
5. ✅ **HTTPS**：Cloudflare 默认提供

---

## ❓ 常见问题速查

### 登录问题
- **忘记密码** → 在 Dashboard 修改 `ADMIN_PASSWORD`
- **立即退出** → 检查 `SESSION_SECRET` 是否配置

### 订阅问题
- **Token无效** → 重新登录生成新链接
- **空内容** → 检查网络和优选选项
- **无法访问** → 检查 Token 和 UUID 格式

### 配置问题
- **统计不显示** → 检查 `AUTH_KV` 是否绑定
- **防暴力破解无效** → 需要配置 KV 存储

---

## 📊 订阅格式说明

- `target=base64` - 标准 Base64（V2Ray/Xray）
- `target=clash` - Clash 配置
- `target=clashr` - ClashR 配置

---

## 🔧 故障排除

| 问题 | 解决方法 |
|------|----------|
| 部署失败 | 检查代码语法，确认文件大小 |
| 登录失败 | 检查环境变量是否正确配置 |
| 订阅为空 | 禁用部分优选选项，检查网络 |
| 统计不准 | 确认 KV 存储已绑定 |

---

## 📝 重要提示

⚠️ **不要**在代码中硬编码密码  
⚠️ **不要**将环境变量值提交到 Git  
⚠️ **不要**使用弱密码  
⚠️ **不要**禁用访问控制（除非测试环境）

---

**详细说明请查看：`使用说明.md`**
